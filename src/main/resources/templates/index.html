<th:block th:replace="~{layout/base :: html(
    title='Personal Finance Tracker',
    bodyClass='bg-gray-100',
    content=~{::content},
    extraHead=~{::extraHead},
    extraScripts=~{::extraScripts}
)}">
    <th:block th:fragment="extraHead">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    </th:block>

    <th:block th:fragment="content">
        <div class="container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Monthly Balance -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Monthly Balance</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-green-100 rounded-lg p-4">
                            <p class="text-sm font-medium text-gray-600">Income</p>
                            <p id="income" class="text-2xl font-bold text-green-600">€0.00</p>
                        </div>
                        <div class="bg-red-100 rounded-lg p-4">
                            <p class="text-sm font-medium text-gray-600">Expenses</p>
                            <p id="expenses" class="text-2xl font-bold text-red-600">€0.00</p>
                        </div>
                    </div>
                    <div class="mt-4 bg-blue-100 rounded-lg p-4">
                        <p class="text-sm font-medium text-gray-600">Balance</p>
                        <p id="balance" class="text-2xl font-bold text-blue-600">€0.00</p>
                    </div>
                </div>


                <!-- Trend Chart -->
                <div class="bg-white rounded-lg shadow-md p-6 col-span-1 md:col-span-2">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Financial Trend</h3>
                    <select id="trendPeriod" class="w-full mb-4 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <option value="3">3 months</option>
                        <option value="6">6 months</option>
                        <option value="12" selected>12 months</option>
                        <option value="24">24 months</option>
                    </select>
                    <div class="h-64">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <!-- Category Management -->
                <div class="bg-white rounded-lg shadow-md p-6 col-span-1 md:col-span-2">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-gray-800">Categories</h3>
                        <button id="addCategoryBtn" class="bg-indigo-600 text-white p-2 rounded-full hover:bg-indigo-700 transition duration-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                    </div>
                    <ul id="categoryList" class="space-y-2">
                        <!-- Categories will be loaded dynamically -->
                    </ul>
                </div>
                <!-- Monthly Budget -->
                <div class="bg-white rounded-lg shadow-md p-6 col-span-1 md:col-span-2">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-gray-800">Budget Progress</h3>
                        <button id="addBudgetBtn" class="bg-indigo-600 text-white p-2 rounded-full hover:bg-indigo-700 transition duration-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="budgetProgressBars" class="space-y-4">
                        <!-- Budget progress bars will be loaded dynamically -->
                    </div>
                </div>

                <!-- Transaction List -->
                <div class="bg-white rounded-lg shadow-md p-6 col-span-1 md:col-span-2 lg:col-span-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold text-gray-800">Transaction List</h3>
                        <button id="addTransactionBtn" class="bg-indigo-600 text-white p-2 rounded-full hover:bg-indigo-700 transition duration-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="flex space-x-2 mb-4">
                        <input type="text" id="transactionSearch" placeholder="Search..." class="flex-grow px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <select id="transactionFilter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="all">All</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table id="transactionTable" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categories</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Transactions will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transaction Details Modal -->
        <div id="transactionDetails" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
            <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Transaction Details</h3>
                <p><strong>Date:</strong> <span id="transactionDate"></span></p>
                <p><strong>Description:</strong> <span id="transactionDescription"></span></p>
                <p><strong>Category:</strong> <span id="transactionCategory"></span></p>
                <p><strong>Amount:</strong> <span id="transactionAmount"></span></p>
                <p><strong>Type:</strong> <span id="transactionType"></span></p>
                <button id="closeTransactionDetails" class="mt-4 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300">Close</button>
            </div>
        </div>

        <!-- Category Details Modal -->
        <div id="categoryDetails" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
            <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Category Details</h3>
                <p><strong>Name:</strong> <span id="categoryName"></span></p>
                <p><strong>Description:</strong> <span id="categoryDescription"></span></p>
                <p><strong>Type:</strong> <span id="categoryType"></span></p>
                <p><strong>Budget:</strong> <span id="categoryBudget"></span></p>
                <p><strong>Total Transactions:</strong> <span id="categoryTotalTransactions"></span></p>
                <p><strong>Transaction Count:</strong> <span id="categoryTransactionCount"></span></p>
                <button id="closeCategoryDetails" class="mt-4 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300">Close</button>
            </div>
        </div>

        <!-- Notification -->
        <div id="notification" class="hidden fixed bottom-4 right-4 p-4 rounded-lg text-white">
            <span id="notificationMessage"></span>
        </div>

        <!-- Budget Modal -->
        <div id="budgetModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
            <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Create New Budget</h3>
                <form id="newBudgetForm" class="space-y-4">
                    <div>
                        <label for="budgetCategory" class="block text-sm font-medium text-gray-700">Category</label>
                        <select id="budgetCategory" name="category" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <!-- Options will be loaded dynamically -->
                        </select>
                    </div>
                    <div>
                        <label for="budgetAmount" class="block text-sm font-medium text-gray-700">Budget Amount</label>
                        <input type="number" id="budgetAmount" name="amount" required min="0" step="0.01" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="closeBudgetModal" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition duration-300">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition duration-300">Create Budget</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Category Modal -->
        <div id="categoryModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
            <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Create New Category</h3>
                <form id="newCategoryForm" class="space-y-4">
                    <div>
                        <label for="newCategoryName" class="block text-sm font-medium text-gray-700">Category Name</label>
                        <input type="text" id="newCategoryName" name="newCategoryName" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="newCategoryType" class="block text-sm font-medium text-gray-700">Category Type</label>
                        <select id="newCategoryType" name="newCategoryType" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="1">Expense</option>
                            <option value="2">Income</option>
                            <option value="3">Both</option>
                        </select>
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="closeCategoryModal" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition duration-300">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition duration-300">Create Category</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Transaction Modal -->
        <div id="transactionModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
            <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Create New Transaction</h3>
                <form id="newTransactionForm" class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">Expense</span>
                        <label class="switch">
                            <input type="checkbox" id="transactionType">
                            <span class="slider round"></span>
                        </label>
                        <span class="text-gray-700">Income</span>
                    </div>
                    <div>
                        <label for="amount" class="block text-sm font-medium text-gray-700">Amount</label>
                        <input type="number" id="amount" name="amount" placeholder="Amount" step="0.01" required min="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="description" class="block text-sm font-medium text-gray-700">Description</label>
                        <input type="text" id="description" name="description" placeholder="Description" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="category" class="block text-sm font-medium text-gray-700">Categories</label>
                        <select id="category" name="category" multiple required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="">Select categories</option>
                        </select>
                    </div>
                    <div>
                        <label for="date" class="block text-sm font-medium text-gray-700">Date</label>
                        <input type="text" id="date" name="date" placeholder="Date" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 flatpickr-input">
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="closeTransactionModal" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition duration-300">Cancel</button>
                        <button type="submit" id="submitTransaction" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition duration-300">Create Transaction</button>
                    </div>
                </form>
            </div>
        </div>
    </th:block>
    
    <th:block th:fragment="extraScripts">
        <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
        <script type="module" th:src="@{/js/main.js}"></script>
    </th:block>
</th:block>
